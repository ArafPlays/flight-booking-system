{%extends 'base.html'%}
{%block title%}Manage Booking{%endblock%}
{%block body%}
    <p>Booking ID: {{booking.id}}<br/>
    Booking Ref: {{booking.ref}}</p>

    
    <!-- take user to confirmed function along with url query parameters -->
    <a href="{{url_for('confirmed',booking_id=booking.id,booking_ref=booking.ref)}}">View booking details</a>
    
    <form method="post">
        <!-- update contact (email,phone) details -->
        <div>
            <h4>Update contact details</h4>
            <label for="email" >Email: </label>
            <input type="email" name="email" value="{{booking.email}}"/><br/>
            <label for="phone" >Phone: </label>
            <input type="tel" name="phone" value="{{booking.phone}}"/><br/>
        </div>
        
        <div>
            <h4>Update passenger details</h4>
            {% for p in passengers %}
                <label for="fname{{p}}" >First name: </label>
                <input type="text" name="fname{{p.id}}" value="{{p.fname}}"/><br/>
                <label for="lname{{p}}" >Last name: </label>
                <input type="text" name="lname{{p.id}}" value="{{p.lname}}"/><br/><br/>
            {%endfor%}
        </div>

        <div>
            <h4>Update meal</h4>
            <label for="meal" >Meal: </label>
            <select name="meal">
                <!-- the if statement pre selects current meal -->
                <option value="No preference" {%if booking.meal=='No preference'%}selected{%endif%}>No preference</option>
                <option value="Halal" {%if booking.meal=='Halal'%}selected{%endif%}>Halal</option>
                <option value="Kosher" {%if booking.meal=='Kosher'%}selected{%endif%}>Kosher</option>
                <option value="Veg" {%if booking.meal=='Veg'%}selected{%endif%}>Veg</option>
            </select>
            <br/>
        </div>

        <button type="submit">Confirm changes</button>
    </form>
    <a href="{{url_for('cancel',booking_id=booking.id,booking_ref=booking.ref)}}">Cancel Booking</a>
{%endblock%}